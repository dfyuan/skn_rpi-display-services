<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>RPi Locator and Display Services: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RPi Locator and Display Services
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RPi Locator and Display Services Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h4>05/12/2016 Added Gtk+-3.0 and GLib2.0 Display Services.</h4>
<h4>05/12/2016 Added GLib and GSSDP command line clients.</h4>
<div class="image">
<img src="https://github.com/skoona/skn_rpi-display-services/raw/master/images/rpi_display.png"  alt="Raspberry Pi Display/Locator Service"/>
</div>
<p>Package includes two features. One designed to both locate your Pi and provide a list of known services. The other acts as a central LCD display service, allowing other network devices/nodes to send a one-liners to the service for display on its LCD.</p>
<p>Each Raspberry Pi, Mac OSX, and Linux node in your network could execute <em>udp_locator_service</em> (LocatorService) as a backgound program using SystemD, a LaunchD PList, or an init script of some sort. The LocatorService collects the address of the machine it running on and creates a entry in its ServiceRegistry; which it sends to clients that requests it.</p>
<p>This establishes the network of locators, for which a <em>udp_locator_client</em> can poll at any time to find your Pi.</p>
<p>Likewise the <em>lcd_display_service</em> executes on nodes that also have an LCD Display of some sort; Serial/USB, MCP23008, or PCF8574 based. It is the provider of the <em>shared LCD Display</em>, and the target of the <em>lcd_display_client</em> (DisplayClient). DisplayClients query all LocatorServices for their active ServiceRegistry, and pickout the default <em>lcd_display_service</em> entry, or via command line option *&ndash;alt-service-name=my_service_name*.</p>
<p>Once a DisplayService is located, the DisplayClient sends a message to the DisplayService to display; from the command line *-m* option. Or if the DisplayClient has been started in *&ndash;non-stop=60* mode, it will send random status messages automatically to the DisplayService; in this case every 30 seconds.</p>
<p>These apps were not intended to be final form applications. Instead they are well formed starters for your own projects.</p>
<p>Enjoy!</p>
<h2>## Executables </h2>
<table class="doxtable">
<tr>
<th>Program</th><th>Type</th><th>Platform</th><th>Port</th><th>Description  </th></tr>
<tr>
<td>*gtkDS</td><td>Server</td><td>any</td><td>48028</td><td>Maintains a list of known network services accessible via UDP socket, and offers the GTK display service. </td></tr>
<tr>
<td>*cmdDS</td><td>Server</td><td>any</td><td>48028</td><td>Maintains a list of known network services accessible via UDP socket, and offers the CmdLine display service. </td></tr>
<tr>
<td>udp_locator_service</td><td>Server</td><td>any</td><td>48028</td><td>Maintains a list of known network services accessible via UDP socket. </td></tr>
<tr>
<td>udp_locator_client</td><td>Client</td><td>any</td><td>n/a</td><td>Collect services info from Service, which includes that service's ip address. </td></tr>
<tr>
<td>*cmdDC</td><td>Client</td><td>any</td><td>n/a</td><td>Sends text one-liner to any display service. </td></tr>
<tr>
<td>lcd_display_service</td><td>Server</td><td>RPi</td><td>48029</td><td>Accepts one-line messages over udp and display them on a LCD panel. </td></tr>
<tr>
<td>lcd_display_client</td><td>Client</td><td>any</td><td>n/a</td><td>Sends one-liner composed of various Pi metrics; like cpus, temps, etc. </td></tr>
<tr>
<td>para_display_client</td><td>Client</td><td>Parallella</td><td>n/a</td><td>Sends one-liner with Zynq chip's temperature. </td></tr>
<tr>
<td>a2d_display_client</td><td>Client</td><td>Rpi</td><td>n/a</td><td>Sends one-liner with measured temp and light sensor values from *AD/DA Shield Module For Raspberry Pi * </td></tr>
<tr>
<td>*gssdpDC</td><td>Client</td><td>any</td><td>n/a</td><td>Sends text one-liner to any display service, after locating it using GSSDP/GUPNP. </td></tr>
</table>
<h2>### Configuration Options </h2>
<h4>Locator Service</h4>
<div class="image">
<img src="https://github.com/skoona/skn_rpi-display-services/raw/master/images/skn_rpi1.png"  alt="Locator Service"/>
</div>
<h4>upd_locator_service &ndash;help</h4>
<pre class="fragment">udp_locator_service -- Provides IPv4 Addres/Port Service info.
          Skoona Development &lt;skoona@gmail.com&gt;
Usage:
  udp_locator_service [-v] [-s] [-m "&lt;delimited-response-message-string&gt;"] [-h|--help]
  udp_locator_service 
  udp_locator_service -s -a mcp_display_service
  udp_locator_service -m 'name=mcp_locator_service, ip=10.100.1.19, port=48028|'

Options:
  -a, --alt-service-name=my_service_name
                 *lcd_display_service* is default, use this to change name.
  -s, --include-display-service  Includes DisplaySerivce in default Registry response.
                *Presumes both are located on same machine; otherwise enter with '-m'*
  -m, --message  ServiceRegistry&lt;delimited-response-message-string&gt; to send.
  -v, --version  Version printout.
  -h, --help     Show this help screen.

  **ServiceRegistry Format:  _&lt;delimited-response-message-string&gt;_**
    delimited-response-message-string : required order -&gt; name,ip,port,line-delimiter...
      format: "name=&lt;service-name&gt;,ip=&lt;service-ipaddress&gt;ddd.ddd.ddd.ddd,port=&lt;service-portnumber&gt;ddddd &lt;line-delimiter&gt;"
        name=&lt;service-name&gt; text_string_with_no_spaces
        ip=&lt;service-ipaddress&gt; ddd.ddd.ddd.ddd
        port=&lt;service-portnumber&gt; ddddd
      REQUIRED   &lt;line-delimiter&gt; is one of these '|', '%', ';'

    **example: -m "name=lcd_display_service,ip=192.168.1.15,port=48028|"**
    ** -m "name=rpi_locator_service, ip=10.100.1.19, port=48028|name=lcd_display_service, ip=10.100.1.19, port=48029|"**
</pre><h4>udp_locator_client &ndash;help</h4>
<p>udp_locator_client &ndash; Collect IPv4 Address/Port Service info from all providers. Skoona Development <a href="#" onclick="location.href='mai'+'lto:'+'sko'+'on'+'a@g'+'ma'+'il.'+'co'+'m'; return false;">skoon<span style="display: none;">.nosp@m.</span>a@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a> Usage: udp_locator_client [-v] [-m 'any text msg'] [-u] [-a 'my_service_name'] [-h|&ndash;help] udp_locator_client udp_locator_client -u -a 'my_service_name'</p>
<p>Options: -a, &ndash;alt-service-name=my_service_name <em>lcd_display_service</em> is default, use this to change name. -u, &ndash;unique-registry List <em>unique</em> entries from all responses. -m, &ndash;message Any text to send; _'<b>QUIT!</b>' causes service to terminate._ _'**ADD **&lt;delimited-response-message-string&gt;' &ndash; add new registry entry into Service_ -v, &ndash;version Version printout. -h, &ndash;help Show this help screen.</p>
<h4>Display Service.</h4>
<div class="image">
<img src="https://github.com/skoona/skn_rpi-display-services/raw/master/images/skn_rpi2.png"  alt="Locator Service"/>
</div>
<blockquote class="doxtable">
<p><b>Supports</b> on the <a href="http://arduino-info.wikispaces.com/LCD-Blue-I2C">'YwRobot Arduino **LCM1602** IIC V1 LCD Backpack'</a></p><ul>
<li>which uses the I2C controller <em>PCF8574</em></li>
<li>example: **_lcd_display_service -r4 -c20 -t pcf_**</li>
<li><b>This is the default.</b> example: **_lcd_display_service_** </li>
</ul>
</blockquote>
<blockquote class="doxtable">
<p><b>Supports</b> <a href="https://www.adafruit.com/products/292">'Adafruit **IC2/SPI** LCD Backpack'</a></p><ul>
<li>which is based on the I2C controller <em>MCP23008</em></li>
<li>example: **_lcd_display_service -r4 -c20 -t mcp_** </li>
</ul>
</blockquote>
<blockquote class="doxtable">
<p><b>Supports</b> <a href="https://www.adafruit.com/products/1110">'Adafruit RGB Negative 16x2 LCD+Keypad Kit'</a></p><ul>
<li>which is based on the I2C controller * MCP23017*</li>
<li>example: **_lcd_display_service -r2 -c16 -t mc7_**</li>
<li>Untested: I don't have one to test </li>
</ul>
</blockquote>
<blockquote class="doxtable">
<p><b>Supports</b> for <a href="https://www.adafruit.com/products/782">'Adafruit **USB/Serial** LCD Backpack'</a></p><ul>
<li>which uses */dev/ttyACM0*</li>
<li>example: **_lcd_display_service -r2 -c16 -p /dev/ttyACM0 -t ser_** </li>
</ul>
</blockquote>
<blockquote class="doxtable">
<p><b>Supports</b> for <a href="http://www.amazon.com/Shield-Module-For-Raspberry-Arduino/dp/B00WGW48A8">'AD / DA Shield Module For Raspberry Pi'</a></p><ul>
<li>which is based on the I2C controller <em>PCF8591T</em> to access:</li>
<li>- on-board temperature sensor; <em>NTC, MF58103J3950, B value 3950K, 1 K ohm 5% Cantherm</em></li>
<li>- on-board light sensors; <em>GL5537-1 CdS Photoresistor</em></li>
<li>example: **_a2d_display_client -i 73_** </li>
</ul>
</blockquote>
<h4>lcd_display_service &ndash;help</h4>
<pre class="fragment">lcd_display_service -- LCD 4x20 Display Provider.
          Skoona Development &lt;skoona@gmail.com&gt;
Usage:
  lcd_display_service [-v] [-m 'Welcome Message'] [-r 4|2] [-c 20|16] [-i 39|32] [-t pcf|mcp|ser|mc7] [-p string] [-h|--help]

Options:
  -r, --rows=dd  Number of rows in physical display.
  -c, --cols=dd  Number of columns in physical display.
  -p, --serial-port=string Serial port.       | ['/dev/ttyACM0']
  -i, --i2c-address=ddd  I2C decimal address. | [0x27=39, 0x20=32]
  -t, --i2c-chipset=ccc  I2C Chipset.         | [pcf|mcp|ser|mc7]
  -m, --message  Welcome Message for line 1.
  -v, --version  Version printout.
  -h, --help     Show this help screen.
</pre><h4>[lcd|para|a2d]_display_client &ndash;help</h4>
<pre class="fragment">lcd_display_client -- Send messages to display service.
          Skoona Development &lt;skoona@gmail.com&gt;
Usage:
  lcd_display_client [-v] [-m 'text msg for display'] [-u] [-n] [-a 'my_service_name'] [-h|--help]
  lcd_display_client -u -m 'Please show this on shared display.'
  lcd_display_client -u -m 'Please show this on shared display.' -a 'ser_display_service'
  lcd_display_client -u -n 60 -a 'ser_display_service'
  lcd_display_client -u -n 60 -a 'mcp_display_service'
  para_display_client -n 330
  a2d_display_client -i 73 -n 330

Options:
  -a, --alt-service-name=my_service_name
                          *lcd_display_service* is default, use this to change name.
  -m, --message           Message to send to display, default: *$ uname -a output*
      _'**QUIT!**' causes service to terminate._
  -n, --non-stop=1|300    Continue to send updates every DD seconds until ctrl-break.
  -u, --unique-registry   List unique entries from all responses.
  -i, --i2c-address=ddd   I2C decimal address. | [0x49=73, 0x20=32]         
  -v, --version           Version printout.
  -h, --help              Show this help screen.
</pre><h2>## Build: Autotools project </h2>
<p>Requires <a href="https://projects.drogon.net/raspberry-pi/wiringpi/download-and-install/">WiringPi</a> and assume the Pi is using <a href="https://www.raspberrypi.org/downloads/">Raspbian</a>. </p><pre class="fragment">$ autoreconf -isfv            *Should not be required: use only if .configure produces errors*
$ ./configure
$ make
$ sudo make install
</pre><p><em>Only lcd_display_service requires <b>WiringPi</b></em>, builds automatically determine if wiringPi is available and build what is available to build.</p>
<h2>## Notes: </h2>
<ul>
<li>WiringPi is a required library for display_service and some of the disply clients. If WiringPI is not present, which is the case with OSX and most Linuxs, then the autoconf will build the udp_locator_service and a limited set of clients. When WiringPi is available all services and clients are built.</li>
<li>Planning to write <em>systemd</em> unit scripts as part of package, add the following to rc.local for now.<ul>
<li>'/&lt;path&gt;/udp_locator_service &gt;&gt; /tmp/udp_locator_service.log 2&gt;&amp;1 &amp;'</li>
</ul>
</li>
<li>SINGLE QUOTES vs double quotes work a lot better for command line options.</li>
</ul>
<h2>## Known Issues: </h2>
<blockquote class="doxtable">
<p>08/08/2015 Found that concurrent I2C operations for LCD updates and reads from */sys/class/thermal/thermal_zone0/temp* cause the <em>lcd_display_service</em> to lockup with a process state of <em>uninterruptible sleep</em>. This is caused by the RPi's internal firmware, with no immediate resolution. To work around this issue, I have removed calls to getCpuTemp() from the lcd_display_service program.</p>
</blockquote>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 13 2016 09:56:02 for RPi Locator and Display Services by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
